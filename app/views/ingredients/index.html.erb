<div>
  <h1> <%= current_user.name %>'s Pantry </h1>
  <div data-controller="toggler">
    <button data-action="toggler#toggle" data-target-name="newForm"> Stock the pantry! </button>
    <div data-toggler-target="newForm" class="d-none">
      <%= render partial: "new"%>
    </div>
  </div>
  <%# Div for filter buttons %>
  <div class="buttons-filter" data-controller="filtering">
    <%# Adding button to render all categories %>
    <button
      class="btn-filter"
      data-action="filtering#showAll"
      data-filtering-target="button">
      All
      </button>
    <% @categories.each do |category| %>
      <button
        class="btn-filter"
        data-action="filtering#fire"
        data-filtering-target="button"
        data-category="<%= category.name %>">
        <%= category.name %>
      </button>
    <% end %>
  </div>
  <div>
  <%# <%# Filters for items expiring in the next 3 days; may need to expand that range %>
  <% expiring = @ingredients.select { |ingredient| ingredient.expiration_date < Date.today + 3 }  %>
  <%# Conditional Guard -- Hides expiring section if expiring array is empty %>
  <% if expiring.any? %>
    <div class="expiring-section">
      <div class="category-title">
        <i class="fa-solid fa-triangle-exclamation"></i></i> <h3> Expiring soon! </h3>
      </div>
      <% expiring.each do |ingredient| %>
        <%= render partial: "ingredients_card", locals: { ingredient: ingredient } %>
      <% end %>
    </div>
  <% end %>
</div>
<div data-controller="filtering">
  <% @categories.each do |category| %>
    <%# Using null class "category-section" to help filtering Stimulus controller. DO NOT DELETE %>
    <div data-category="<%= category.name %>" class="category-section">
      <%= render partial: "category", locals: { category: category, ingredients: @ingredients } %>
    </div>
  <% end %>
</div>
